/*! Rappid v2.1.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2017-09-21 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


joint.dia.Paper.prototype.toSVG=function(a,b){function c(){return(new XMLSerializer).serializeToString(f).replace(/&nbsp;/g,"Â ")}function d(a){var b=V(m.shift());if(!b)return a();var c=b.attr("xlink:href")||b.attr("href");joint.util.imageToDataUri(c,function(c,e){b.attr("xlink:href",e),d(a)})}b=b||{},this.trigger("beforeexport",b);var e=b.area?b.area:V.transformRect(this.getContentBBox(),this.matrix().inverse()),f=this.svg.cloneNode(!0);f.removeAttribute("style"),b.preserveDimensions&&V(f).attr({width:e.width,height:e.height}),V(f).findOne(".joint-viewport").removeAttr("transform"),V(f).attr("viewBox",e.x+" "+e.y+" "+e.width+" "+e.height);for(var g=document.styleSheets.length,h=[],i=g-1;i>=0;i--)h[i]=document.styleSheets[i],document.styleSheets[i].disabled=!0;var j={};$(this.svg).find("*").each(function(a){var b=window.getComputedStyle(this,null),c={};_.each(b,function(a){c[a]=b.getPropertyValue(a)}),j[a]=c}),g!=document.styleSheets.length&&_.each(h,function(a,b){document.styleSheets[b]=a});for(var k=0;k<g;k++)document.styleSheets[k].disabled=!1;var l={};$(this.svg).find("*").each(function(a){var b=window.getComputedStyle(this,null),c=j[a],d={};_.each(b,function(a){b.getPropertyValue(a)!==c[a]&&(d[a]=b.getPropertyValue(a))}),l[a]=d});var m=[];return $(f).find("*").each(function(a){$(this).css(l[a]),"image"===this.tagName.toLowerCase()&&m.push(this)}),this.trigger("afterexport",b),b.convertImagesToDataUris&&m.length?void d(function(){a(c())}):a(c())},joint.dia.Paper.prototype.openAsSVG=function(a){var b="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",c=_.uniqueId("svg_output");this.toSVG(function(a){var d=window.open("",c,b),e="data:image/svg+xml,"+encodeURIComponent(a);d.document.write('<img src="'+e+'" style="max-height:100%" />')},_.extend({convertImagesToDataUris:!0},a))};