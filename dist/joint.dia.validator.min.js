/*! Rappid v2.1.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2017-09-21 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


joint.dia.Validator=Backbone.Model.extend({initialize:function(a){this._map={},this._commandManager=a.commandManager,this.listenTo(this._commandManager,"add",this._onCommand)},defaults:{cancelInvalid:!0},_onCommand:function(a){return _.isArray(a)?_.find(a,function(a){return!this._validateCommand(a)},this):this._validateCommand(a)},_validateCommand:function(a){if(a.options&&a.options.validation===!1)return!0;var b;return _.each(this._map[a.action],function(c){function d(f){var g=c[e++];try{if(!g)return void(b=f);g(f,a,d)}catch(f){d(f)}}var e=0;d(b)}),!b||(this.get("cancelInvalid")&&this._commandManager.cancel(),this.trigger("invalid",b),!1)},validate:function(a){var b=Array.prototype.slice.call(arguments,1);return _.each(b,function(b){if(!_.isFunction(b))throw new Error(a+" requires callback functions.")}),_.each(a.split(" "),function(a){(this._map[a]=this._map[a]||[]).push(b)},this),this}});