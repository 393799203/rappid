/*! Rappid v2.1.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2017-09-21 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


!function(a,b,c,d){function e(a,b,d){d=c.defaults(d||{},{siblingGap:0}),this.width=0,this.height=0,this.layoutAreas=this.sortLayoutAreas(a),this.parentArea=b,this.siblingGap=d.siblingGap,this.exists()&&this.computeSize(d)}function f(a,b,d){var e=c.extend({},d,this.getRootAttributes(a,d.attributeNames)),f=d.gap||0;c.defaults(e,{parentGap:f,siblingGap:f,firstChildGap:f}),this.root=a,this.childAreas=b,this.siblingRank=e.siblingRank,this.rootOffset=e.rootOffset,this.nextSiblingGap=e.nextSiblingGap,this.prevSiblingGap=e.prevSiblingGap,this.gap=this.parentGap=e.parentGap,this.firstChildGap=e.firstChildGap,this.dx=0,this.dy=0,this.width=0,this.height=0,c.invoke(b,"addParentReference",this),this.computeRelativePosition(a,b,e)}c.extend(e.prototype,{sortLayoutAreas:function(a){var b=c.sortBy(a,"siblingRank");return c.each(b,function(a,b){a.siblingRank=b}),b},move:function(a,b){c.each(this.layoutAreas,function(c){c.dx+=a,c.dy+=b})},exists:function(){return this.layoutAreas.length>0},sumGaps:function(a){var b=Math.max(this.layoutAreas.length-1,0);return b*a},getSiblingRankByPoint:function(a){if(!this.exists())return-1;var b=this.findAreaByPoint(a);return b?b.siblingRank-1:this.layoutAreas.length-1},getFirstChildConnectionPoints:function(){return[]},getConnectionPoints:function(a,b){if(!this.exists())return this.getFirstChildConnectionPoints(a);var c={dx:a.x-this.parentArea.rootCX,dy:a.y-this.parentArea.rootCY};return this.layoutAreas[0].getRootVertices(c,b)},getParentConnectionPoint:function(){var a=this.parentArea,b=this.proxyLayoutArea("getConnectionPoint",a.rootSize),c=d.point(a.rootCX,a.rootCY);return c.offset(b.x,b.y)},getChildConnectionPoint:function(a,b){var c=this.proxyLayoutArea("getConnectionPoint",b);return d.point(a).difference(c)},proxyLayoutArea:function(a){var b=Array.prototype.slice.call(arguments,1);return f.fromDirection(this.direction).prototype[a].apply(this.parentArea,b)}}),e.extend=b.Model.extend;var g=e.extend({getTopDY:function(){return-this.height/2},findAreaByPoint:function(a){return c.find(this.layoutAreas,function(b){return b.rootCY>a.y})},computeSize:function(a){this.height=this.sumGaps(a.siblingGap),this.height+=c.sum(this.layoutAreas,function(a){return a.height+a.prevSiblingGap+a.nextSiblingGap}),c.reduce(this.layoutAreas,function(b,c){return this.width=Math.max(this.width,c.getExtendedWidth()),c.dy+=b+c.getCY(),b+c.prevSiblingGap+c.height+c.nextSiblingGap+a.siblingGap},this.getTopDY(),this)},getYTowardsParent:function(){return this.parentArea.rootCY},getXTowardsParent:function(){var a=this.parentArea;return a.rootCX+this.LRSign*(a.rootSize.width/2+a.gap)},getNeighborPointFromRank:function(a){var b,c=this.siblingGap;if(this.exists()){var d=this.layoutAreas[a],e=this.layoutAreas[a+1];b=d?e?(d.y+d.height+e.y)/2:d.y+d.height+c/2:e.y-c/2}else b=this.getYTowardsParent();return{x:this.getXTowardsParent(),y:b}}}),h=g.extend({direction:"L",LRSign:-1}),i=g.extend({direction:"R",LRSign:1}),j={getXTowardsParent:function(){var a=this.parentArea;return a.rootCX+this.LRSign*a.gap},getYTowardsParent:function(){var a=this.parentArea,b=a.getLRHeight(a.siblings)/2;return b+=Math.min(a.firstChildGap,this.siblingGap/2),a.rootCY+this.TBSign*b},getFirstChildConnectionPoints:function(a){return[d.point(this.parentArea.rootCX,a.y)]},getChildConnectionPoint:function(a,b){return d.point(a).offset(-this.LRSign*b.width/2,0)},getParentConnectionPoint:function(){var a=this.parentArea,b=d.point(a.rootCX,a.rootCY);return b.offset(0,this.TBSign*a.rootSize.height/2)}},k={getTopDY:function(){return 0}},l={getTopDY:function(){return-this.height}},m=g.extend({direction:"BR",LRSign:1,TBSign:1});c.extend(m.prototype,j,k);var n=g.extend({direction:"BL",LRSign:-1,TBSign:1});c.extend(n.prototype,j,k);var o=g.extend({direction:"TR",LRSign:1,TBSign:-1});c.extend(o.prototype,j,l);var p=g.extend({direction:"TL",LRSign:-1,TBSign:-1});c.extend(p.prototype,j,l);var q=e.extend({getLeftDX:function(){return-this.width/2},findAreaByPoint:function(a){return c.find(this.layoutAreas,function(b){return b.rootCX>a.x})},computeSize:function(a){this.width=this.sumGaps(a.siblingGap),this.width+=c.sum(this.layoutAreas,function(a){return a.width+a.prevSiblingGap+a.nextSiblingGap}),c.reduce(this.layoutAreas,function(b,c){return this.height=Math.max(this.height,c.getExtendedHeight()),c.dx+=b+c.getCX(),b+c.prevSiblingGap+c.width+c.nextSiblingGap+a.siblingGap},this.getLeftDX(),this)},getNeighborPointFromRank:function(a){var b;if(this.exists()){var c=this.layoutAreas[a],d=this.layoutAreas[a+1];b=c?d?(c.x+c.width+d.x)/2:c.x+c.width+this.siblingGap/2:d.x-this.siblingGap/2}else b=this.parentArea.rootCX;return{x:b,y:this.getYTowardsParent()}}}),r=q.extend({direction:"T",getYTowardsParent:function(){var a=this.parentArea;return a.rootCY-a.getLRHeight()/2-a.gap}}),s=q.extend({direction:"B",getYTowardsParent:function(){var a=this.parentArea;return a.rootCY+a.getLRHeight()/2+a.gap}});c.extend(f,{create:function(a,b,c,d){var e=f.fromDirection(a,d);return new e(b,c,d)},fromDirection:function(a,b){var c;switch(a){case"L":c=u;break;case"T":c=v;break;case"R":c=t;break;case"B":c=w;break;case"BR":c=x;break;case"BL":c=y;break;case"TR":c=z;break;case"TL":c=A;break;default:c=f}return c}}),c.extend(f.prototype,{direction:null,getHeight:function(a,b){return this.getTHeight(a)+this.getBHeight(a)+this.getLRHeight()},getWidth:function(a,b){var c=Math.max(a.T.width,a.B.width)/2,d=Math.max(this.getLWidth(a,b)+b.width/2,c),e=Math.max(this.getRWidth(a,b)+b.width/2,c);return d+e},getLRHeight:function(){return Math.max(this.rootSize.height,this.siblings.L.height,this.siblings.R.height)},getTHeight:function(a){return a.T.height+this.getTXHeight(a)},getBHeight:function(a){return a.B.height+this.getBXHeight(a)},getXLRWidth:function(a,b){return this.getLWidth(a,b)+b.width+this.getRWidth(a,b)},getXRWidth:function(a,b){var c=Math.max(a.BR.width,a.TR.width);return c>0&&(c-=b.width/2),c},getTXHeight:function(a){var b=Math.max(a.TR.height,a.TL.height);return b>0&&(b+=this.firstChildGap),b},getBXHeight:function(a){var b=Math.max(a.BR.height,a.BL.height);return b>0&&(b+=this.firstChildGap),b},getXLWidth:function(a,b){var c=Math.max(a.BL.width,a.TL.width);return c>0&&(c-=b.width/2),c},getRWidth:function(a,b){return Math.max(a.R.width,this.getXRWidth(a,b))},getLWidth:function(a,b){return Math.max(a.L.width,this.getXLWidth(a,b))},getTBOverlap:function(a,b){var c=Math.max(a.T.width,a.B.width);return c>0&&(c-=b.width,c/=2),c},getRootDX:function(a,b){var c=this.getTBOverlap(a,b),d=Math.max(this.getLWidth(a,b),c);return d-=Math.max(this.getRWidth(a,b),c),d/2},getMinimalGap:function(a){return Math.min(a.siblingGap,this.firstChildGap,this.parentGap)},getBBox:function(a){var b=d.rect(this),c=a&&a.expandBy;return c&&b.moveAndExpand({x:-c,y:-c,width:2*c,height:2*c}),b},containsPoint:function(a,b){return this.getBBox(b).containsPoint(a)},getLayoutSiblings:function(a){return this.siblings[a]},getExtendedWidth:function(){return this.width+this.gap+this.rootOffset},getExtendedHeight:function(){return this.height+this.gap+this.rootOffset},findMinimalAreaByPoint:function(a,b){if(!this.containsPoint(a,b))return null;var d;return c.some(this.childAreas,function(c){return d=c.findMinimalAreaByPoint(a,b),!!d}),d||this},getType:function(){return c.reduce(this.siblings,function(a,b,c){return b.exists()?a.concat(c):a},[]).sort().join("-")},addParentReference:function(a){this.parentArea=a},getRootAttributes:function(a,b){var d=a.get(b.siblingRank||"siblingRank");return{siblingRank:c.isNumber(d)?d:null,rootOffset:a.get(b.offset||"offset")||0,rootMargin:a.get(b.margin||"margin")||0,prevSiblingGap:a.get(b.prevSiblingGap||"prevSiblingGap")||0,nextSiblingGap:a.get(b.nextSiblingGap||"nextSiblingGap")||0}},getRootSize:function(a,b){var d=c.clone(a.get("size"));return d[this.marginDimension]+=b,d},createSiblings:function(a,b){var d=c.groupBy(a,"direction");return{L:new h(d.L,this,b),T:new r(d.T,this,b),R:new i(d.R,this,b),B:new s(d.B,this,b),BR:new m(d.BR,this,b),BL:new n(d.BL,this,b),TR:new o(d.TR,this,b),TL:new p(d.TL,this,b)}},computeSize:function(a,b){return{width:this.getWidth(a,b),height:this.getHeight(a,b)}},computeOrigin:function(){var a=this.siblings,b=this.rootSize,c=Math.max(this.getLWidth(a,b)+b.width/2,this.getXLWidth(a,b)+b.width/2,a.T.width/2,a.B.width/2);return{x:this.rootCX-c,y:this.rootCY-this.getTHeight(a)-this.getLRHeight()/2}},moveSiblings:function(a,b){if(this.hasHorizontalSiblings(a)){var c=b.width/2;a.L.move(-c,0),a.R.move(c,0)}if(this.hasVerticalSiblings(a)){var d=this.getLRHeight()/2;a.T.move(0,-d),a.B.move(0,d),a.BR.move(0,d),a.BL.move(0,d),a.B.move(0,this.getBXHeight(a)),a.TR.move(0,-d),a.TL.move(0,-d),a.T.move(0,-this.getTXHeight(a))}},moveRootToConnectionPoint:function(a){var b=this.getConnectionPoint(a);this.dx+=b.x,this.dy+=b.y},computeRelativePosition:function(a,b,d){var e=this.siblings=this.createSiblings(b,{siblingGap:d.siblingGap}),f=this.rootSize=this.getRootSize(a,d.rootMargin);c.extend(this,this.computeSize(e,f)),this.moveSiblings(e,f),this.moveRootToConnectionPoint(f),this.moveRootBehindSiblings(e,f),this.moveRootFromParent()},computeAbsolutePosition:function(){if(this.parentArea)this.rootCX=this.parentArea.rootCX+this.dx,this.rootCY=this.parentArea.rootCY+this.dy,this.level=this.parentArea.level+1;else{var a=this.root.getBBox().center();this.rootCX=a.x,this.rootCY=a.y,this.level=0}c.extend(this,this.computeOrigin())},hasVerticalSiblings:function(a){return a.T.exists()||a.B.exists()||a.BR.exists()||a.BL.exists()||a.TR.exists()||a.TL.exists()},hasHorizontalSiblings:function(a){return a.L.exists()||a.R.exists()},isSourceArea:function(){return!this.parentArea},isSinkArea:function(){return 0===this.childAreas.length},getRootPosition:function(){var a=this.root.get("size");return{x:this.rootCX-a.width/2,y:this.rootCY-a.height/2}},getRootVertices:function(a,b){if(b=b||{},a=a||this,0===a[this.deltaCoordinate]||!this.parentArea)return[];var d,e=this.parentArea.getInnerSize();if(!b.ignoreSiblings&&this.hasSiblingsBetweenParent()){var f=this.siblings[this.oppositeDirection];d=this.getRelativeVerticesAvoidingSiblings(e,a,f)}else d=this.getRelativeVertices(e,a);return c.invoke(d,"offset",this.parentArea.rootCX,this.parentArea.rootCY)},getInnerSize:function(){return{width:this.rootSize.width,height:this.getLRHeight()}},getConnectionPoint:function(){return null},getRelativeVertices:function(){return null},moveRootFromParent:function(){},moveRootBehindSiblings:function(){},hasSiblingsBetweenParent:function(){return!this.isSourceArea()&&this.siblings[this.oppositeDirection].exists()},getCY:function(){return this.height/2+this.prevSiblingGap},getCX:function(){return this.width/2+this.prevSiblingGap}}),f.extend=b.Model.extend;var t=f.extend({direction:"R",oppositeDirection:"L",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(a){return d.point(a.width/2,0)},moveRootBehindSiblings:function(a,b){this.dx+=Math.max(this.getLWidth(a,b),this.getTBOverlap(a,b)),this.dy+=(this.getTHeight(a)-this.getBHeight(a))/2},moveRootFromParent:function(){this.dx+=this.parentGap+this.rootOffset},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a),d=this.parentGap/2;return[c.clone().offset(d,0),c.clone().offset(d,b.dy)]},getRelativeVerticesAvoidingSiblings:function(a,b,c){var d=this.getConnectionPoint(a),e=c.siblingGap/2,f=this.dx>0?-1:1,g=b.dy+f*(c.height+e)/2,h=b.dy+f*this.rootSize.height/4,i=this.gap/2,j=1.5*i+Math.max(this.getLWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[d.clone().offset(i,0),d.clone().offset(i,g),d.clone().offset(j,g),d.clone().offset(j,h)]}}),u=f.extend({direction:"L",oppositeDirection:"R",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(a){return d.point(-a.width/2,0)},moveRootBehindSiblings:function(a,b){this.dx-=Math.max(this.getRWidth(a,b),this.getTBOverlap(a,b)),this.dy+=(this.getTHeight(a)-this.getBHeight(a))/2},moveRootFromParent:function(){this.dx-=this.parentGap+this.rootOffset},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a),d=-this.parentGap/2;return[c.clone().offset(d,0),c.clone().offset(d,b.dy)]},getRelativeVerticesAvoidingSiblings:function(a,b,c){var d=this.getConnectionPoint(a),e=this.dx>0?-1:1,f=b.dy+e*(c.height+c.siblingGap/2)/2,g=b.dy+e*this.rootSize.height/4,h=this.gap/2,i=1.5*h+Math.max(this.getRWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[d.clone().offset(-h,0),d.clone().offset(-h,f),d.clone().offset(-i,f),d.clone().offset(-i,g)]}}),v=f.extend({direction:"T",oppositeDirection:"B",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(a){return d.point(0,-a.height/2)},moveRootBehindSiblings:function(a,b){this.dx+=this.getRootDX(a,b),this.hasHorizontalSiblings(a)&&(this.dy-=(this.getLRHeight()-b.height)/2),this.dy-=this.getBHeight(a)},moveRootFromParent:function(){this.dy-=this.parentGap+this.rootOffset},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a),d=-this.getTXHeight(this.parentArea.siblings)-this.parentGap/2;return[c.clone().offset(0,d),c.clone().offset(b.dx,d)]},getRelativeVerticesAvoidingSiblings:function(a,b){var c=this.getConnectionPoint(a),d=this.siblings,e=d.B,f=this.getTXHeight(this.parentArea.siblings)+this.parentGap/2,g=f+e.height;g+=this.getBXHeight(this.siblings)+this.parentGap/4;var h=this.dy<0?-1:1,i=d[h>0?"BR":"BL"].width,j=b.dx;j+=h*(Math.max(i,e.width/2)+e.siblingGap/4);var k=b.dx+h*this.rootSize.width/4;return[c.clone().offset(0,-f),c.clone().offset(j,-f),c.clone().offset(j,-g),c.clone().offset(k,-g)]}}),w=f.extend({direction:"B",oppositeDirection:"T",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(a){return d.point(0,a.height/2)},moveRootBehindSiblings:function(a,b){this.dx+=this.getRootDX(a,b),this.dy+=this.getTHeight(a),this.hasHorizontalSiblings(a)&&(this.dy+=(this.getLRHeight()-b.height)/2)},moveRootFromParent:function(){this.dy+=this.parentGap+this.rootOffset},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a),d=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2;return[c.clone().offset(0,d),c.clone().offset(b.dx,d)]},getRelativeVerticesAvoidingSiblings:function(a,b){var c=this.getConnectionPoint(a),d=this.siblings,e=d.T,f=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2,g=f+e.height;g+=this.getTXHeight(d)+this.parentGap/4;var h=this.dy<0?-1:1,i=d[h>0?"TR":"TL"].width,j=b.dx;j+=h*(Math.max(i,e.width/2)+e.siblingGap/4);var k=b.dx+h*this.rootSize.width/4;return[c.clone().offset(0,f),c.clone().offset(j,f),c.clone().offset(j,g),c.clone().offset(k,g)]}}),x=f.extend({direction:"BR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(a){return d.point(0,a.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(a,b){var c=Math.max(a.T.width,a.B.width);this.dx+=Math.max(this.getLWidth(a,b),(c-b.width)/2),this.dy+=this.getTHeight(a),this.hasHorizontalSiblings(a)&&(this.dy+=(this.getLRHeight()-b.height)/2)},moveRootFromParent:function(){this.dy+=this.firstChildGap,this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a);return[c.clone().offset(0,b.dy-a.height/2)]},getRelativeVerticesAvoidingSiblings:function(a,b,c){var e=b.dx-this.rootSize.width/4,f=b.dy;return f+=Math.max(c.height,this.rootSize.height)/2,f+=this.getMinimalGap(c)/2,[d.point(0,f),d.point(e,f)]}}),y=f.extend({direction:"BL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(a){return d.point(0,a.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(a,b){var c=Math.max(a.T.width,a.B.width);this.dx-=Math.max(this.getRWidth(a,b),(c-b.width)/2),this.dy+=this.getTHeight(a),this.hasHorizontalSiblings(a)&&(this.dy+=(this.getLRHeight()-b.height)/2)},moveRootFromParent:function(){this.dy+=this.firstChildGap,this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a);return[c.clone().offset(0,b.dy-a.height/2)]},getRelativeVerticesAvoidingSiblings:function(a,b,c){var e=b.dx+this.rootSize.width/4,f=b.dy;return f+=Math.max(c.height,this.rootSize.height)/2,f+=this.getMinimalGap(c)/2,[d.point(0,f),d.point(e,f)]}}),z=f.extend({direction:"TR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(a){return d.point(0,a.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(a,b){this.dx+=Math.max(this.getLWidth(a,b),this.getTBOverlap(a,b)),this.dy-=this.getBHeight(a),this.hasHorizontalSiblings(a)&&(this.dy-=(this.getLRHeight()-b.height)/2)},moveRootFromParent:function(){this.dy-=this.firstChildGap,this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a);return[c.clone().offset(0,b.dy-a.height/2)]},getRelativeVerticesAvoidingSiblings:function(a,b,c){var e=b.dx-this.rootSize.width/4,f=b.dy;return f-=Math.max(c.height,this.rootSize.height)/2,f-=this.getMinimalGap(c)/2,[d.point(0,f),d.point(e,f)]}}),A=f.extend({direction:"TL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(a){return d.point(0,a.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(a,b){this.dx-=Math.max(this.getRWidth(a,b),this.getTBOverlap(a,b)),this.dy-=this.getBHeight(a),this.hasHorizontalSiblings(a)&&(this.dy-=(this.getLRHeight()-b.height)/2)},moveRootFromParent:function(){this.dy-=this.firstChildGap,this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(a,b){var c=this.getConnectionPoint(a);return[c.clone().offset(0,b.dy-a.height/2)]},getRelativeVerticesAvoidingSiblings:function(a,b,c){var e=b.dx+this.rootSize.width/4,f=b.dy;return f-=Math.max(c.height,this.rootSize.height)/2,f-=this.getMinimalGap(c)/2,[d.point(0,f),d.point(e,f)]}}),B={rotate:function(a){var b="LRBT",c=b.indexOf(a[0])-b.indexOf(a[1]);return function(a){var d=b.indexOf(a);return d>=0?b[(4+d-c)%4]:a}},flip:function(a){var b=a[0],c=a[1];return function(a){return a===b?c:a===c?b:a}},straighten:function(a){return c.constant(a[1])}},C=b.Model.extend({defaults:{graph:void 0,gap:20,parentGap:20,siblingGap:20,firstChildGap:20,direction:"R",directionRule:B.straighten,updatePosition:function(a,b,c){a.set("position",b,c)},updateVertices:function(a,b,c){a.set("vertices",b,c)},updateAttributes:null,filter:null,attributeNames:{}},initialize:function(){this._cacheOptions(this.attributes),this.layoutAreas={}},layout:function(a){return this.layoutAreas={},c.each(this.getGraphSources(a),c.partial(this.layoutTree,c,a),this),this.trigger("layout:done",a),this},layoutTree:function(a,b){b=b||{},b.treeLayout=!0;var c=this._computeLayoutAreas(a,this.get("direction"),b);return this._computeAbsolutePositions(c),this._updateCells(c,b),this},getLayoutArea:function(a){return this.layoutAreas[a.id||a]||null},getRootLayoutAreas:function(){return c.map(this.getGraphSources(),this.getLayoutArea,this)},getGraphSources:function(a){var b=this.graph.getSources();return this.filter&&b.length>0&&(b=this.filter(b,null,a)||b),b},getMinimalRootAreaByPoint:function(a){var b=c.filter(this.getRootLayoutAreas(),function(b){return b.containsPoint(a)});return c.isEmpty(b)?null:c.min(b,function(a){return a.width*a.height})},_computeLayoutAreas:function(a,b,d){var e=a.get(this.getAttributeName("direction"))||b,g=this._getChildren(a,d),h=c.map(g,c.partial(this._computeLayoutAreas,c,e,d),this),i=f.create(e,a,h,this.attributes);return i.link=this.graph.getConnectedLinks(a,{inbound:!0})[0],this.layoutAreas[a.id]=i,i},_cacheOptions:function(a){var b=["updateAttributes","updateVertices","updatePosition","filter"];c.each(b,function(b){this[b]=c.isFunction(a[b])?a[b]:null},this),this.graph=a.graph},_getChildren:function(a,b){var c=this.graph.getNeighbors(a,{outbound:!0});return this.filter&&c.length>0&&(c=this.filter(c,a,b)||c),c},_computeAbsolutePositions:function(a){a.computeAbsolutePosition(a),c.each(a.childAreas,this._computeAbsolutePositions,this)},_updateCells:function(a,b){var d=a.root,e=a.link||null;e&&(this.updatePosition&&this.updatePosition(d,a.getRootPosition(),b),this.updateVertices&&this.updateVertices(e,a.getRootVertices(),b)),this.changeSiblingRank(d,a.siblingRank,b),this.updateAttributes&&this.updateAttributes(a,d,e,b),c.each(a.childAreas,c.partial(this._updateCells,c,b),this)},updateDirections:function(a,b,d){d=d||{};var e=this.getAttributeName("direction"),f=this.get("directionRule")(b);this.graph.search(a,c.bind(function(a,b){if(0!==b){var c=f(a.get(e));this.changeDirection(a,c,d)}},this),{outbound:!0})},reconnectElement:function(a,b,c){c=c||{};var d=this.getLayoutArea(a),e=d.link;if(e){e.set("source",{id:b.id||b},c);var f=d.direction,g=c.direction||f,h=c.siblingRank||void 0;return this.changeSiblingRank(a,h,c),this.changeDirection(a,g,c),f!==g&&this.updateDirections(a,[f,c.direction],c),!0}return!1},changeSiblingRank:function(a,b,c){a.set(this.getAttributeName("siblingRank"),b,c)},changeDirection:function(a,b,c){a.set(this.getAttributeName("direction"),b,c)},getAttributeName:function(a){return this.get("attributeNames")[a]||a},getAttribute:function(a,b){return a.get(this.getAttributeName(b))},prepare:function(){return this}},{directionRules:B});a.layout.TreeLayout=C}(joint,Backbone,_,g);